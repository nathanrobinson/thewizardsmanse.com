<!DOCTYPE html>
<html>
   <head>
   <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="XN4YmHgE76jTp2kNQ9qnsVSApl6yIQBzdyLe0BnbFks" />

  <title>
    
    
    Automatic Paging with Knockout data-bindings - The Wizard&#39;s Manse
    
  </title>
  <link rel="shortcut icon" href="/favicon.ico" />
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/bootstrap-theme.min.css">

  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/holder.min.js" type='text/javascript'></script>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="canonical" href="https://www.thewizardsmanse.com/automatic-paging-with-knockout-data-bindings/">
  

<link rel="stylesheet" href="/css/bootstrap-toc.min.css" type="text/css">

<script src="/js/bootstrap-toc.min.js" type="text/javascript"></script>
   </head>
   <body data-spy="scroll" data-target="#toc">
     <header class="navbar navbar-inverse navbar-fixed-top" id="top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.thewizardsmanse.com">The Wizard&#39;s Manse</a>
    </div>

    
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
	
	
	<li  ><a href="/">Home</a></li>
	
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

      </ul>
</nav>
</header>

     <div class="jumbotron masthead" role="main">
       <div class="container">
	 <div class="row">
	   <div class="col-sm-3">

		 <nav id="toc" data-spy="affix" data-toggle="toc"></nav>
  </div>

 	   <div class="col-md-8 col-md-offset-2">
	   
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/github.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
<script type="text/javascript">
  hljs.initHighlightingOnLoad();
$(document).ready(function() {
  $('pre').each(function(i, block) {
  hljs.highlightBlock(block);
  });
});
</script>

<div class="panel panel-default">
  <div class="panel-body">
      <article itemscope itemtype="http://schema.org/BlogPosting" id="post" >
	<h1 itemprop="name headline"> Automatic Paging with Knockout data-bindings </h1>
	<p>
	  
	  <small class="text-muted">
	    <span itemprop="author" itemscope itemtype="http://schema.org/Person" >
	      <span itemprop="name">Nathan Robinson</span>
	    </span>  posted by:&nbsp;<time itemprop="datePublished"  content="Tue Sep 3,3096"  datetime="2013-09-03 20:55:38 &#43;0000 &#43;0000" itemprop="datePublished">Tue Sep 3, 2013 </time>
	  </small>
	</p>

	<p>
	  
	  <a href='/'><span class="label label-danger"></span></a>

	</p>


	<hr/>
	<span itemprop="articleBody">
	  <p>I&#8217;ve been a heavy user of <a title="Knockout JS" href="http://knockoutjs.com/" target="_blank">Knockout JS</a> and MVVM with JavaScript for over a year and I&#8217;ve found most designs can be achieved with the basic data-bindings. There are two scenarios that I have found which require specialized bindings. The first is a select box with numerous options. The second is a long list of data that doesn&#8217;t fit on a single screen.</p>

<p>I prefer to use the <a title="chosen jQuery plugin" href="http://harvesthq.github.io/chosen/" target="_blank">chosen jQuery plugin</a> to manage unwieldy select boxes. The problem is combining the jQuery plugin with Knockout data-binding. For this I use a <a title="Knockout Binding Extension For Chosen" href="http://www.nuget.org/packages/cb.ko.binding.chosen/" target="_blank">Knockout Binding Extension For Chosen</a>. One caveat on this binding is that it can take a while to bind. If you have multiple select boxes with large amounts of data displaying dynamically, you can notice a significant delay. I ran into this problem when binding to an editable grid. The entire grid would display with the select boxes hidden until the user selects that row for editing. The grid would lag by up to 10 seconds while all the select boxes rendered using the chosen plugin. To speed up the grid I wrapped each select box in a span with an &#8220;if&#8221; binding. This kept the select boxes from rendering until the user actually edited that row. Since only one row&#8217;s worth of select boxes were being rendered instead of all rows, the delay wasn&#8217;t as noticeable.</p>

<p>The long list of data that doesn&#8217;t fit on a single screen is a much different problem. To solve this I wanted a paging solution similar to the <a title="Data Tables plugin" href="https://datatables.net/" target="_blank">data tables plugin for jQuery</a>.</p>

<p><a title="Data Tables" href="http://screencast.com/t/2ZJlLiT6j" target="_blank"><img class="embeddedObject" alt="" src="http://content.screencast.com/users/NathanJRobinson/folders/Jing/media/a81333be-7527-49b9-a5c4-fd9a26a8a0cb/2013-09-02_1711-thumb.png" width="400" height="162" border="0" /></a></p>

<p>The important functionality that I wanted were the ability to change the page size, the page links, and of course, the actual paging. Originally, I started out building the paging mechanics directly into my view models, but this created a lot of duplication both in the view model and in the html. My next step was to pull the paging functions out of the view model and put them into a base model that could extend any view model with paging functionality. It turns out the paging functionality is easy to encapsulate; for any paged list, you need to track the current page, the number of items per page, and the total number of items. From there it&#8217;s fairly simple to calculate the items to display on the current page.</p>

<pre class="brush: jscript; title: ; notranslate" title="">self.page = ko.observable(1);

    self.itemsPerPage = ko.observable(10);

    self.totalPages = ko.computed(function () {
                var array = observableArray();
                return Math.ceil(array.length / self.itemsPerPage());
            });

    self.pagedItems = ko.computed(function () {
                var array = observableArray();
                var indexOfFirstItemOnCurrentPage = (((self.page() * 1) - 1) * (self.itemsPerPage() * 1));
                var pageArray = array.slice(indexOfFirstItemOnCurrentPage, indexOfFirstItemOnCurrentPage + (self.itemsPerPage()* 1));
                return pageArray;
            });
</pre>

<p>The problem of repeating the html for the knockout binding isn&#8217;t solved with a view model, though. What I really wanted was a drop-in replacement for the foreach binding that would work on any list and would wrap up all the paging functionality. There is a <a title="SimpleGrid" href="https://github.com/knockout/knockout/tree/gh-pages/examples/resources" target="_blank">SimpleGrid</a> knockout binding that does paging, but it replaces the current html node with its own idea of how your data should be rendered. I wanted to use the inline template that the foreach binding uses so that I could page a table, an un-ordered list, or a bunch of divs. In order to be a true drop-in replacement for foreach, I had to separate out the three elements of the pager: the page size control, the paged items, and the page links. I call my pager binding like so:</p>

<pre class="brush: xml; title: ; notranslate" title="">&lt;div id="testBinding"&gt;
            &lt;div data-bind="pageSizeControl: observableArray, pageSize: pageSize"&gt;&lt;/div&gt;
            &lt;table&gt;
                &lt;thead&gt;
                    &lt;tr&gt;&lt;th&gt;$index&lt;/th&gt;&lt;th&gt;Key&lt;/th&gt;&lt;th&gt;Value&lt;/th&gt;&lt;th&gt;Page Size&lt;/th&gt;&lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody data-bind="pagedForeach: observableArray"&gt;
                    &lt;tr&gt;
                        &lt;td data-bind="text: $index"&gt;&lt;/td&gt;
                        &lt;td data-bind="text: key"&gt;&lt;/td&gt;
                        &lt;td data-bind="text: value"&gt;&lt;/td&gt;
                        &lt;td class="parentPageSize" data-bind="text: $parent.pageSize"&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/tbody&gt;
            &lt;/table&gt;
            &lt;div data-bind="pageLinks: observableArray"&gt;&lt;/div&gt;
        &lt;/div&gt;
</pre>

<p>I have four bindings that I can choose from which give me detailed control over the paging while also letting me reuse the code in a modular way.</p>

<pre>pagedForeach: displays the current page of items
    pageLinks: displays the first page, last page, and page number navigation links
    pageSizeControl: displays a select box with four standard page sizes to choose from
    pageSize: lets your view model control the page size directly
</pre>

<p>I checked in the binding to github as <a href="https://github.com/nathanrobinson/knockout.pager" title="knockout.pager" target="_blank">knockout.pager</a>. I then used <a href="http://www.myget.org/" title="myGet" target="_blank">myGet </a>to package the files and upload them to <a href="http://www.nuget.org/packages/knockout.pager/" title="knockout.pager" target="_blank">nuGet</a>. I also built several <a href="https://rawgithub.com/nathanrobinson/knockout.pager/master/tests.html" title="unit tests" target="_blank">unit tests</a>. One thing you may notice is that in my bindings I attach the paging view model to the array. This is because the other bindings can see the same view model. In order to work correctly, the bindings have to interact with the same view model. Rather than calling the foreach binding from my binding, I looked at the knockout source and so that foreach is simply a wrapper for the template binding, so I call the template binding directly. I also used the same method of generating templates for the page links and pager size controls that the SimpleGrid binding used.</p>
	</span>

	
	<hr/>
<p>
  
    <strong>Categories</strong>:


	  
	<a class="btn btn-default btn-xs" href="/categories/code">Code</a>
	
	<a class="btn btn-default btn-xs" href="/categories/javascript">JavaScript</a>
	
	<a class="btn btn-default btn-xs" href="/categories/knockout">Knockout</a>
	
	<br/>
	
	
<strong>Tags:</strong>
  <a itemprop="keywords" class=" label label-danger" href="/tags/javascript">JavaScript</a> <a itemprop="keywords" class=" label label-danger" href="/tags/mvvm">MVVM</a> <a itemprop="keywords" class=" label label-danger" href="/tags/knockout.js">knockout.js</a>


	<hr/>
	
<style>
div.adwrapper { width: 100%; }
ins.responsive { width: 336px; height: 280px; }
@media(min-width: 561px) { ins.responsive { height: 60px; width: 468px; margin: 0 auto; } }
@media(min-width: 992px) { ins.responsive { height: 600px; width: 120px; margin: 0; position: fixed; top: 100px; right: 0; } }
@media(min-width: 1200px) { ins.responsive { height: 600px; width: 160px; } }
</style>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<div class="adwrapper">
<ins class="adsbygoogle responsive"
     style="display:block"
     data-ad-client="ca-pub-8600046037791786"
     data-ad-slot="3462697759"
     data-ad-format="auto"></ins>
</div>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<hr/>

 <script type="text/javascript" src='//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-58d6920fd8eec028'></script> 
 <div class="addthis_inline_share_toolbox"></div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'thewizardsmanse';
    var disqus_identifier = 'https:\/\/www.thewizardsmanse.com\/automatic-paging-with-knockout-data-bindings\/';
    var disqus_title = 'Automatic Paging with Knockout data-bindings';
    var disqus_url = 'https:\/\/www.thewizardsmanse.com\/automatic-paging-with-knockout-data-bindings\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



      </div>
      </div></article>


	 </div>

	 </div>
       </div>
     </div>

 <footer class="container footer">
  <div class="row">
    <div class="col-md-10">
      <small class="text-muted">Copyright (c) 2017 The Wizard&#39;s Manse.</small>
    </div>
    <div class="col-md-2">
      <small class="text-muted"></small>
      </div>
   </div>
 </footer>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-36145597-1', 'auto');
ga('send', 'pageview');
</script>

<script>
    Running=1;
</script>
<script async src="/ads.js"></script>
<script async src="/script.js"></script>

</body></html>
